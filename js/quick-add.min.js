(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

// Copy to clipboard.
jQuery(function ($) {
	var $clipboardLinks = $('.plt-copy-short-url');
	if (ClipboardJS.isSupported()) {
		$clipboardLinks.click(function (e) {
			return e.preventDefault();
		});
	} else {
		$clipboardLinks.hide();
	}

	$('.plt-links-to button').click(function (e) {
		$('#cws-links-to').focus();
	});

	var clipboard = new ClipboardJS('.plt-copy-short-url');
	var copied = pltVars.copied;
	var browserNoSupportCopying = pltVars.browserNoSupportCopying;

	clipboard.on('success', function (e) {
		var $trigger = $(e.trigger);

		$trigger.text(copied);
		setTimeout(function () {
			return $trigger.text($trigger.data('original-text'));
		}, 4000);
	});

	clipboard.on('error', function (e) {
		var $trigger = $(e.trigger);

		$trigger.text(browserNoSupportCopying);
		setTimeout(function () {
			return $clipboardLinks.hide();
		}, 4000);
	});
});

// Quick Add.
jQuery(function ($) {
	var $modal = $('#plt-quick-add');
	var $form = $modal.find('form:first');
	var $saveDraft = $('#plt-quick-add-save');
	var $publish = $('#plt-quick-add-publish');
	var $menuItem = $('a[href$="post_type=page&page=plt-add-page-link"], a[href$="#new-page-link"]');
	var $messages = $modal.find('.messages');
	var $shortUrlMessage = $modal.find('.short-url-message');
	var $title = $modal.find('[name="title"]');
	var $url = $modal.find('[name="url"]');
	var $slug = $modal.find('[name="slug"]');
	var nonce = $modal.find('[name="plt_nonce"]').val();
	var defaultSlugPlaceholder = $slug.prop('placeholder');
	var fancyUrls = window.pltVars.fancyUrls;
	var yes = true,
	    no = false;


	var modalAction = function modalAction(action) {
		return function () {
			return $modal.dialog(action);
		};
	};
	var isOpen = modalAction('isOpen');
	var open = modalAction('open');
	var close = modalAction('close');

	var makeSlugFromTitle = function makeSlugFromTitle() {
		var title = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

		return title.toLowerCase().replace(/\s+/g, '-').replace(/-{2,}/g, '-').replace(/[^a-z0-9-]/, '').replace(/-$/, '').replace(/^-/, '');
	};

	var makeSlugFromSlug = function makeSlugFromSlug() {
		var slug = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

		return slug.toLowerCase().replace(/\s+/g, '-').replace(/-{2,}/g, '-').replace(/[^a-z0-9-]/, '').replace(/^-/, '');
	};

	var addMessage = function addMessage(message) {
		var $newMessage = $('<p>' + message + '</p>');
		$messages.append($newMessage);
		return $newMessage;
	};

	var addExpiringMessage = function addExpiringMessage(message, duration) {
		var $newMessage = addMessage(message);
		setTimeout(function () {
			return $newMessage.fadeOut();
		}, duration);
		return $newMessage;
	};

	var displayShortUrlMessage = function displayShortUrlMessage(show) {
		return $shortUrlMessage.toggle(show);
	};

	var updateSlug = function updateSlug() {
		var placeholderSlug = makeSlugFromTitle($title.val());
		var slug = makeSlugFromSlug($slug.val());

		$slug.prop('placeholder', placeholderSlug.length ? placeholderSlug : defaultSlugPlaceholder);
		$slug.val(slug);
	};

	var noDefaultEvent = function noDefaultEvent(func) {
		return function (e) {
			e.preventDefault();
			func();
		};
	};

	var hardUpdateSlug = noDefaultEvent(function () {
		return $slug.val(makeSlugFromTitle($slug.val()));
	});

	var handleShowSlugMessage = noDefaultEvent(function () {
		return displayShortUrlMessage($slug.prop('placeholder').length > 16 && !$slug.val().length);
	});

	var reset = function reset() {
		$title.val('');
		$url.val('');
		$slug.val('');
		$slug.prop('placeholder', defaultSlugPlaceholder);
		maybeUpdateButtons();
	};

	var updateButtons = function updateButtons() {
		var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : yes;

		$publish.prop('disabled', !enabled);
		$saveDraft.prop('disabled', !enabled);
	};

	var maybeUpdateButtons = function maybeUpdateButtons() {
		return updateButtons($title.val().length && $url.val().length);
	};

	var submit = function submit() {
		var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
		    _ref$publish = _ref.publish,
		    publish = _ref$publish === undefined ? yes : _ref$publish;

		var title = $title.val();
		var url = $url.val();
		var slug = $slug.val() ? $slug.val() : makeSlugFromTitle(title);

		$.post(ajaxurl, {
			action: 'plt_quick_add',
			plt_title: title,
			plt_url: url,
			plt_slug: slug,
			plt_publish: publish ? 1 : 0,
			plt_nonce: nonce
		}, function (response) {
			var message = response.data.message;

			var delay = 5000;
			reset();
			$title.focus();
			addExpiringMessage(message, delay);
		});
	};

	var clickMenuItem = noDefaultEvent(function () {
		return isOpen() ? close() : open();
	});
	var saveDraft = noDefaultEvent(function () {
		return submit({ publish: no });
	});
	var publish = noDefaultEvent(function () {
		return submit({ publish: yes });
	});

	$modal.dialog({
		title: 'Add Page Link',
		dialogClass: 'wp-dialog',
		autoOpen: no,
		draggable: no,
		width: 'auto',
		modal: yes,
		resizable: no,
		closeOnEscape: yes,
		position: {
			my: 'center',
			at: 'center',
			of: window
		},
		open: function open() {
			return $('.ui-widget-overlay').bind('click', close);
		},
		create: function create() {
			return $('.ui-dialog-titlebar-close').addClass('ui-button');
		}
	});

	// Events.
	if (fancyUrls) {
		$title.keyup(updateSlug);
		$title.keyup(handleShowSlugMessage);
		$slug.keyup(updateSlug);
		$slug.keyup(handleShowSlugMessage);
		$form.change(hardUpdateSlug);
	}

	$menuItem.click(clickMenuItem);
	$saveDraft.click(saveDraft);
	$publish.click(publish);
	$form.submit(publish);
	$title.keyup(maybeUpdateButtons);
	$url.keyup(maybeUpdateButtons);
	$form.change(maybeUpdateButtons);

	// Init.
	reset();
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9xdWljay1hZGQuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQTtBQUNBLE9BQU8sYUFBSztBQUNYLEtBQU0sa0JBQWtCLEVBQUUscUJBQUYsQ0FBeEI7QUFDQSxLQUFJLFlBQVksV0FBWixFQUFKLEVBQStCO0FBQzlCLGtCQUFnQixLQUFoQixDQUFzQjtBQUFBLFVBQUssRUFBRSxjQUFGLEVBQUw7QUFBQSxHQUF0QjtBQUNBLEVBRkQsTUFFTztBQUNOLGtCQUFnQixJQUFoQjtBQUNBOztBQUVELEdBQUUsc0JBQUYsRUFBMEIsS0FBMUIsQ0FBZ0MsYUFBSztBQUNwQyxJQUFFLGVBQUYsRUFBbUIsS0FBbkI7QUFDQSxFQUZEOztBQUtBLEtBQU0sWUFBWSxJQUFJLFdBQUosQ0FBZ0IscUJBQWhCLENBQWxCO0FBQ0EsS0FBTSxTQUFTLFFBQVEsTUFBdkI7QUFDQSxLQUFNLDBCQUEwQixRQUFRLHVCQUF4Qzs7QUFFQSxXQUFVLEVBQVYsQ0FBYSxTQUFiLEVBQXdCLGFBQUs7QUFDNUIsTUFBTSxXQUFXLEVBQUUsRUFBRSxPQUFKLENBQWpCOztBQUVBLFdBQVMsSUFBVCxDQUFjLE1BQWQ7QUFDQSxhQUFXO0FBQUEsVUFBTSxTQUFTLElBQVQsQ0FBYyxTQUFTLElBQVQsQ0FBYyxlQUFkLENBQWQsQ0FBTjtBQUFBLEdBQVgsRUFBZ0UsSUFBaEU7QUFDQSxFQUxEOztBQU9BLFdBQVUsRUFBVixDQUFhLE9BQWIsRUFBc0IsYUFBSztBQUMxQixNQUFNLFdBQVcsRUFBRSxFQUFFLE9BQUosQ0FBakI7O0FBRUEsV0FBUyxJQUFULENBQWMsdUJBQWQ7QUFDQSxhQUFXO0FBQUEsVUFBTSxnQkFBZ0IsSUFBaEIsRUFBTjtBQUFBLEdBQVgsRUFBeUMsSUFBekM7QUFDQSxFQUxEO0FBTUEsQ0E5QkQ7O0FBZ0NBO0FBQ0EsT0FBTyxhQUFLO0FBQ1gsS0FBTSxTQUFTLEVBQUUsZ0JB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QUFGLEVBQStCLFFBQS9CLENBQXdDLFdBQXhDLENBQU47QUFBQTtBQWZLLEVBQWQ7O0FBa0JBO0FBQ0EsS0FBSSxTQUFKLEVBQWU7QUFDZCxTQUFPLEtBQVAsQ0FBYSxVQUFiO0FBQ0EsU0FBTyxLQUFQLENBQWEscUJBQWI7QUFDQSxRQUFNLEtBQU4sQ0FBWSxVQUFaO0FBQ0EsUUFBTSxLQUFOLENBQVkscUJBQVo7QUFDQSxRQUFNLE1BQU4sQ0FBYSxjQUFiO0FBQ0E7O0FBRUQsV0FBVSxLQUFWLENBQWdCLGFBQWhCO0FBQ0EsWUFBVyxLQUFYLENBQWlCLFNBQWpCO0FBQ0EsVUFBUyxLQUFULENBQWUsT0FBZjtBQUNBLE9BQU0sTUFBTixDQUFhLE9BQWI7QUFDQSxRQUFPLEtBQVAsQ0FBYSxrQkFBYjtBQUNBLE1BQUssS0FBTCxDQUFXLGtCQUFYO0FBQ0EsT0FBTSxNQUFOLENBQWEsa0JBQWI7O0FBRUE7QUFDQTtBQUNBLENBcEtEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLy8gQ29weSB0byBjbGlwYm9hcmQuXG5qUXVlcnkoJCA9PiB7XG5cdGNvbnN0ICRjbGlwYm9hcmRMaW5rcyA9ICQoJy5wbHQtY29weS1zaG9ydC11cmwnKTtcblx0aWYgKENsaXBib2FyZEpTLmlzU3VwcG9ydGVkKCkpIHtcblx0XHQkY2xpcGJvYXJkTGlua3MuY2xpY2soZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xuXHR9IGVsc2Uge1xuXHRcdCRjbGlwYm9hcmRMaW5rcy5oaWRlKCk7XG5cdH1cblxuXHQkKCcucGx0LWxpbmtzLXRvIGJ1dHRvbicpLmNsaWNrKGUgPT4ge1xuXHRcdCQoJyNjd3MtbGlua3MtdG8nKS5mb2N1cygpO1xuXHR9KTtcblxuXG5cdGNvbnN0IGNsaXBib2FyZCA9IG5ldyBDbGlwYm9hcmRKUygnLnBsdC1jb3B5LXNob3J0LXVybCcpO1xuXHRjb25zdCBjb3BpZWQgPSBwbHRWYXJzLmNvcGllZDtcblx0Y29uc3QgYnJvd3Nlck5vU3VwcG9ydENvcHlpbmcgPSBwbHRWYXJzLmJyb3dzZXJOb1N1cHBvcnRDb3B5aW5nO1xuXG5cdGNsaXBib2FyZC5vbignc3VjY2VzcycsIGUgPT4ge1xuXHRcdGNvbnN0ICR0cmlnZ2VyID0gJChlLnRyaWdnZXIpO1xuXG5cdFx0JHRyaWdnZXIudGV4dChjb3BpZWQpO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4gJHRyaWdnZXIudGV4dCgkdHJpZ2dlci5kYXRhKCdvcmlnaW5hbC10ZXh0JykpLCA0MDAwKTtcblx0fSk7XG5cblx0Y2xpcGJvYXJkLm9uKCdlcnJvcicsIGUgPT4ge1xuXHRcdGNvbnN0ICR0cmlnZ2VyID0gJChlLnRyaWdnZXIpO1xuXG5cdFx0JHRyaWdnZXIudGV4dChicm93c2VyTm9TdXBwb3J0Q29weWluZyk7XG5cdFx0c2V0VGltZW91dCgoKSA9PiAkY2xpcGJvYXJkTGlua3MuaGlkZSgpLCA0MDAwKTtcblx0fSk7XG59KTtcblxuLy8gUXVpY2sgQWRkLlxualF1ZXJ5KCQgPT4ge1xuXHRjb25zdCAkbW9kYWwgPSAkKCcjcGx0LXF1aWNrLWFkZCcpO1xuXHRjb25zdCAkZm9ybSA9ICRtb2RhbC5maW5kKCdmb3JtOmZpcnN0Jyk7XG5cdGNvbnN0ICRzYXZlRHJhZnQgPSAkKCcjcGx0LXF1aWNrLWFkZC1zYXZlJyk7XG5cdGNvbnN0ICRwdWJsaXNoID0gJCgnI3BsdC1xdWljay1hZGQtcHVibGlzaCcpO1xuXHRjb25zdCAkbWVudUl0ZW0gPSAkKFxuXHRcdCdhW2hyZWYkPVwicG9zdF90eXBlPXBhZ2UmcGFnZT1wbHQtYWRkLXBhZ2UtbGlua1wiXSwgYVtocmVmJD1cIiNuZXctcGFnZS1saW5rXCJdJ1xuXHQpO1xuXHRjb25zdCAkbWVzc2FnZXMgPSAkbW9kYWwuZmluZCgnLm1lc3NhZ2VzJyk7XG5cdGNvbnN0ICRzaG9ydFVybE1lc3NhZ2UgPSAkbW9kYWwuZmluZCgnLnNob3J0LXVybC1tZXNzYWdlJyk7XG5cdGNvbnN0ICR0aXRsZSA9ICRtb2RhbC5maW5kKCdbbmFtZT1cInRpdGxlXCJdJyk7XG5cdGNvbnN0ICR1cmwgPSAkbW9kYWwuZmluZCgnW25hbWU9XCJ1cmxcIl0nKTtcblx0Y29uc3QgJHNsdWcgPSAkbW9kYWwuZmluZCgnW25hbWU9XCJzbHVnXCJdJyk7XG5cdGNvbnN0IG5vbmNlID0gJG1vZGFsLmZpbmQoJ1tuYW1lPVwicGx0X25vbmNlXCJdJykudmFsKCk7XG5cdGNvbnN0IGRlZmF1bHRTbHVnUGxhY2Vob2xkZXIgPSAkc2x1Zy5wcm9wKCdwbGFjZWhvbGRlcicpO1xuXHRjb25zdCBmYW5jeVVybHMgPSB3aW5kb3cucGx0VmFycy5mYW5jeVVybHM7XG5cdGNvbnN0IFt5ZXMsIG5vXSA9IFt0cnVlLCBmYWxzZV07XG5cblx0Y29uc3QgbW9kYWxBY3Rpb24gPSBhY3Rpb24gPT4gKCkgPT4gJG1vZGFsLmRpYWxvZyhhY3Rpb24pO1xuXHRjb25zdCBpc09wZW4gPSBtb2RhbEFjdGlvbignaXNPcGVuJyk7XG5cdGNvbnN0IG9wZW4gPSBtb2RhbEFjdGlvbignb3BlbicpO1xuXHRjb25zdCBjbG9zZSA9IG1vZGFsQWN0aW9uKCdjbG9zZScpO1xuXG5cdGNvbnN0IG1ha2VTbHVnRnJvbVRpdGxlID0gKHRpdGxlID0gJycpID0+IHtcblx0XHRyZXR1cm4gdGl0bGVcblx0XHRcdC50b0xvd2VyQ2FzZSgpXG5cdFx0XHQucmVwbGFjZSgvXFxzKy9nLCAnLScpXG5cdFx0XHQucmVwbGFjZSgvLXsyLH0vZywgJy0nKVxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05LV0vLCAnJylcblx0XHRcdC5yZXBsYWNlKC8tJC8sICcnKVxuXHRcdFx0LnJlcGxhY2UoL14tLywgJycpO1xuXHR9O1xuXG5cdGNvbnN0IG1ha2VTbHVnRnJvbVNsdWcgPSAoc2x1ZyA9ICcnKSA9PiB7XG5cdFx0cmV0dXJuIHNsdWdcblx0XHRcdC50b0xvd2VyQ2FzZSgpXG5cdFx0XHQucmVwbGFjZSgvXFxzKy9nLCAnLScpXG5cdFx0XHQucmVwbGFjZSgvLXsyLH0vZywgJy0nKVxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05LV0vLCAnJylcblx0XHRcdC5yZXBsYWNlKC9eLS8sICcnKTtcblx0fTtcblxuXHRjb25zdCBhZGRNZXNzYWdlID0gbWVzc2FnZSA9PiB7XG5cdFx0Y29uc3QgJG5ld01lc3NhZ2UgPSAkKGA8cD4ke21lc3NhZ2V9PC9wPmApO1xuXHRcdCRtZXNzYWdlcy5hcHBlbmQoJG5ld01lc3NhZ2UpO1xuXHRcdHJldHVybiAkbmV3TWVzc2FnZTtcblx0fTtcblxuXHRjb25zdCBhZGRFeHBpcmluZ01lc3NhZ2UgPSAobWVzc2FnZSwgZHVyYXRpb24pID0+IHtcblx0XHRjb25zdCAkbmV3TWVzc2FnZSA9IGFkZE1lc3NhZ2UobWVzc2FnZSk7XG5cdFx0c2V0VGltZW91dCgoKSA9PiAkbmV3TWVzc2FnZS5mYWRlT3V0KCksIGR1cmF0aW9uKTtcblx0XHRyZXR1cm4gJG5ld01lc3NhZ2U7XG5cdH07XG5cblx0Y29uc3QgZGlzcGxheVNob3J0VXJsTWVzc2FnZSA9IHNob3cgPT4gJHNob3J0VXJsTWVzc2FnZS50b2dnbGUoc2hvdyk7XG5cblx0Y29uc3QgdXBkYXRlU2x1ZyA9ICgpID0+IHtcblx0XHRjb25zdCBwbGFjZWhvbGRlclNsdWcgPSBtYWtlU2x1Z0Zyb21UaXRsZSgkdGl0bGUudmFsKCkpO1xuXHRcdGNvbnN0IHNsdWcgPSBtYWtlU2x1Z0Zyb21TbHVnKCRzbHVnLnZhbCgpKTtcblxuXHRcdCRzbHVnLnByb3AoXG5cdFx0XHQncGxhY2Vob2xkZXInLFxuXHRcdFx0cGxhY2Vob2xkZXJTbHVnLmxlbmd0aCA/IHBsYWNlaG9sZGVyU2x1ZyA6IGRlZmF1bHRTbHVnUGxhY2Vob2xkZXJcblx0XHQpO1xuXHRcdCRzbHVnLnZhbChzbHVnKTtcblx0fTtcblxuXHRjb25zdCBub0RlZmF1bHRFdmVudCA9IGZ1bmMgPT4gZSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGZ1bmMoKTtcblx0fTtcblxuXHRjb25zdCBoYXJkVXBkYXRlU2x1ZyA9IG5vRGVmYXVsdEV2ZW50KCgpID0+XG5cdFx0JHNsdWcudmFsKG1ha2VTbHVnRnJvbVRpdGxlKCRzbHVnLnZhbCgpKSlcblx0KTtcblxuXHRjb25zdCBoYW5kbGVTaG93U2x1Z01lc3NhZ2UgPSBub0RlZmF1bHRFdmVudCgoKSA9PlxuXHRcdGRpc3BsYXlTaG9ydFVybE1lc3NhZ2UoXG5cdFx0XHQkc2x1Zy5wcm9wKCdwbGFjZWhvbGRlcicpLmxlbmd0aCA+IDE2ICYmICEkc2x1Zy52YWwoKS5sZW5ndGhcblx0XHQpXG5cdCk7XG5cblx0Y29uc3QgcmVzZXQgPSAoKSA9PiB7XG5cdFx0JHRpdGxlLnZhbCgnJyk7XG5cdFx0JHVybC52YWwoJycpO1xuXHRcdCRzbHVnLnZhbCgnJyk7XG5cdFx0JHNsdWcucHJvcCgncGxhY2Vob2xkZXInLCBkZWZhdWx0U2x1Z1BsYWNlaG9sZGVyKTtcblx0XHRtYXliZVVwZGF0ZUJ1dHRvbnMoKTtcblx0fTtcblxuXHRjb25zdCB1cGRhdGVCdXR0b25zID0gKGVuYWJsZWQgPSB5ZXMpID0+IHtcblx0XHQkcHVibGlzaC5wcm9wKCdkaXNhYmxlZCcsICFlbmFibGVkKTtcblx0XHQkc2F2ZURyYWZ0LnByb3AoJ2Rpc2FibGVkJywgIWVuYWJsZWQpO1xuXHR9O1xuXG5cdGNvbnN0IG1heWJlVXBkYXRlQnV0dG9ucyA9ICgpID0+XG5cdFx0dXBkYXRlQnV0dG9ucygkdGl0bGUudmFsKCkubGVuZ3RoICYmICR1cmwudmFsKCkubGVuZ3RoKTtcblxuXHRjb25zdCBzdWJtaXQgPSAoeyBwdWJsaXNoID0geWVzIH0gPSB7fSkgPT4ge1xuXHRcdGNvbnN0IHRpdGxlID0gJHRpdGxlLnZhbCgpO1xuXHRcdGNvbnN0IHVybCA9ICR1cmwudmFsKCk7XG5cdFx0bGV0IHNsdWcgPSAkc2x1Zy52YWwoKSA/ICRzbHVnLnZhbCgpIDogbWFrZVNsdWdGcm9tVGl0bGUodGl0bGUpO1xuXG5cdFx0JC5wb3N0KFxuXHRcdFx0YWpheHVybCxcblx0XHRcdHtcblx0XHRcdFx0YWN0aW9uOiAncGx0X3F1aWNrX2FkZCcsXG5cdFx0XHRcdHBsdF90aXRsZTogdGl0bGUsXG5cdFx0XHRcdHBsdF91cmw6IHVybCxcblx0XHRcdFx0cGx0X3NsdWc6IHNsdWcsXG5cdFx0XHRcdHBsdF9wdWJsaXNoOiBwdWJsaXNoID8gMSA6IDAsXG5cdFx0XHRcdHBsdF9ub25jZTogbm9uY2UsXG5cdFx0XHR9LFxuXHRcdFx0cmVzcG9uc2UgPT4ge1xuXHRcdFx0XHRjb25zdCB7IG1lc3NhZ2UgfSA9IHJlc3BvbnNlLmRhdGE7XG5cdFx0XHRcdGNvbnN0IGRlbGF5ID0gNTAwMDtcblx0XHRcdFx0cmVzZXQoKTtcblx0XHRcdFx0JHRpdGxlLmZvY3VzKCk7XG5cdFx0XHRcdGFkZEV4cGlyaW5nTWVzc2FnZShtZXNzYWdlLCBkZWxheSk7XG5cdFx0XHR9XG5cdFx0KTtcblx0fTtcblxuXHRjb25zdCBjbGlja01lbnVJdGVtID0gbm9EZWZhdWx0RXZlbnQoKCkgPT4gKGlzT3BlbigpID8gY2xvc2UoKSA6IG9wZW4oKSkpO1xuXHRjb25zdCBzYXZlRHJhZnQgPSBub0RlZmF1bHRFdmVudCgoKSA9PiBzdWJtaXQoeyBwdWJsaXNoOiBubyB9KSk7XG5cdGNvbnN0IHB1Ymxpc2ggPSBub0RlZmF1bHRFdmVudCgoKSA9PiBzdWJtaXQoeyBwdWJsaXNoOiB5ZXMgfSkpO1xuXG5cdCRtb2RhbC5kaWFsb2coe1xuXHRcdHRpdGxlOiAnQWRkIFBhZ2UgTGluaycsXG5cdFx0ZGlhbG9nQ2xhc3M6ICd3cC1kaWFsb2cnLFxuXHRcdGF1dG9PcGVuOiBubyxcblx0XHRkcmFnZ2FibGU6IG5vLFxuXHRcdHdpZHRoOiAnYXV0bycsXG5cdFx0bW9kYWw6IHllcyxcblx0XHRyZXNpemFibGU6IG5vLFxuXHRcdGNsb3NlT25Fc2NhcGU6IHllcyxcblx0XHRwb3NpdGlvbjoge1xuXHRcdFx0bXk6ICdjZW50ZXInLFxuXHRcdFx0YXQ6ICdjZW50ZXInLFxuXHRcdFx0b2Y6IHdpbmRvdyxcblx0XHR9LFxuXHRcdG9wZW46ICgpID0+ICQoJy51aS13aWRnZXQtb3ZlcmxheScpLmJpbmQoJ2NsaWNrJywgY2xvc2UpLFxuXHRcdGNyZWF0ZTogKCkgPT4gJCgnLnVpLWRpYWxvZy10aXRsZWJhci1jbG9zZScpLmFkZENsYXNzKCd1aS1idXR0b24nKSxcblx0fSk7XG5cblx0Ly8gRXZlbnRzLlxuXHRpZiAoZmFuY3lVcmxzKSB7XG5cdFx0JHRpdGxlLmtleXVwKHVwZGF0ZVNsdWcpO1xuXHRcdCR0aXRsZS5rZXl1cChoYW5kbGVTaG93U2x1Z01lc3NhZ2UpO1xuXHRcdCRzbHVnLmtleXVwKHVwZGF0ZVNsdWcpO1xuXHRcdCRzbHVnLmtleXVwKGhhbmRsZVNob3dTbHVnTWVzc2FnZSk7XG5cdFx0JGZvcm0uY2hhbmdlKGhhcmRVcGRhdGVTbHVnKTtcblx0fVxuXG5cdCRtZW51SXRlbS5jbGljayhjbGlja01lbnVJdGVtKTtcblx0JHNhdmVEcmFmdC5jbGljayhzYXZlRHJhZnQpO1xuXHQkcHVibGlzaC5jbGljayhwdWJsaXNoKTtcblx0JGZvcm0uc3VibWl0KHB1Ymxpc2gpO1xuXHQkdGl0bGUua2V5dXAobWF5YmVVcGRhdGVCdXR0b25zKTtcblx0JHVybC5rZXl1cChtYXliZVVwZGF0ZUJ1dHRvbnMpO1xuXHQkZm9ybS5jaGFuZ2UobWF5YmVVcGRhdGVCdXR0b25zKTtcblxuXHQvLyBJbml0LlxuXHRyZXNldCgpO1xufSk7XG4iXX0=
