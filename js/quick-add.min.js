(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

jQuery(function ($) {
	var $modal = $('#plt-quick-add');
	var $form = $modal.find('form:first');
	var $saveDraft = $('#plt-quick-add-save');
	var $publish = $('#plt-quick-add-publish');
	var $menuItem = $('a[href$="post_type=page&page=plt-add-page-link"], a[href$="#new-page-link"]');
	var $messages = $modal.find('.messages');
	var $shortUrlMessage = $modal.find('.short-url-message');
	var $title = $modal.find('[name="title"]');
	var $url = $modal.find('[name="url"]');
	var $slug = $modal.find('[name="slug"]');
	var nonce = $modal.find('[name="plt_nonce"]').val();
	var defaultSlugPlaceholder = $slug.prop('placeholder');
	var fancyUrls = window.pltVars.fancyUrls;
	var yes = true,
	    no = false;


	var modalAction = function modalAction(action) {
		return function () {
			return $modal.dialog(action);
		};
	};
	var isOpen = modalAction('isOpen');
	var open = modalAction('open');
	var close = modalAction('close');

	var makeSlugFromTitle = function makeSlugFromTitle() {
		var title = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

		return title.toLowerCase().replace(/\s+/g, '-').replace(/-{2,}/g, '-').replace(/[^a-z0-9-]/, '').replace(/-$/, '').replace(/^-/, '');
	};

	var makeSlugFromSlug = function makeSlugFromSlug() {
		var slug = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

		return slug.toLowerCase().replace(/\s+/g, '-').replace(/-{2,}/g, '-').replace(/[^a-z0-9-]/, '').replace(/^-/, '');
	};

	var addMessage = function addMessage(message) {
		var $newMessage = $('<p>' + message + '</p>');
		$messages.append($newMessage);
		return $newMessage;
	};

	var addExpiringMessage = function addExpiringMessage(message, duration) {
		var $newMessage = addMessage(message);
		setTimeout(function () {
			return $newMessage.fadeOut();
		}, duration);
		return $newMessage;
	};

	var displayShortUrlMessage = function displayShortUrlMessage(show) {
		return $shortUrlMessage.toggle(show);
	};

	var updateSlug = function updateSlug() {
		var placeholderSlug = makeSlugFromTitle($title.val());
		var slug = makeSlugFromSlug($slug.val());

		$slug.prop('placeholder', placeholderSlug.length ? placeholderSlug : defaultSlugPlaceholder);
		$slug.val(slug);
	};

	var noDefaultEvent = function noDefaultEvent(func) {
		return function (e) {
			e.preventDefault();
			func();
		};
	};

	var hardUpdateSlug = noDefaultEvent(function () {
		return $slug.val(makeSlugFromTitle($slug.val()));
	});

	var handleShowSlugMessage = noDefaultEvent(function () {
		return displayShortUrlMessage($slug.prop('placeholder').length > 16 && !$slug.val().length);
	});

	var reset = function reset() {
		$title.val('');
		$url.val('');
		$slug.val('');
		$slug.prop('placeholder', defaultSlugPlaceholder);
		maybeUpdateButtons();
	};

	var updateButtons = function updateButtons() {
		var enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : yes;

		$publish.prop('disabled', !enabled);
		$saveDraft.prop('disabled', !enabled);
	};

	var maybeUpdateButtons = function maybeUpdateButtons() {
		return updateButtons($title.val().length && $url.val().length);
	};

	var submit = function submit() {
		var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
		    _ref$publish = _ref.publish,
		    publish = _ref$publish === undefined ? yes : _ref$publish;

		var title = $title.val();
		var url = $url.val();
		var slug = $slug.val() ? $slug.val() : makeSlugFromTitle(title);

		$.post(ajaxurl, {
			action: 'plt_quick_add',
			plt_title: title,
			plt_url: url,
			plt_slug: slug,
			plt_publish: publish ? 1 : 0,
			plt_nonce: nonce
		}, function (response) {
			var message = response.data.message;

			var delay = 5000;
			reset();
			$title.focus();
			addExpiringMessage(message, delay);
		});
	};

	var clickMenuItem = noDefaultEvent(function () {
		return isOpen() ? close() : open();
	});
	var saveDraft = noDefaultEvent(function () {
		return submit({ publish: no });
	});
	var publish = noDefaultEvent(function () {
		return submit({ publish: yes });
	});

	$modal.dialog({
		title: 'Add Page Link',
		dialogClass: 'wp-dialog',
		autoOpen: no,
		draggable: no,
		width: 'auto',
		modal: yes,
		resizable: no,
		closeOnEscape: yes,
		position: {
			my: 'center',
			at: 'center',
			of: window
		},
		open: function open() {
			return $('.ui-widget-overlay').bind('click', close);
		},
		create: function create() {
			return $('.ui-dialog-titlebar-close').addClass('ui-button');
		}
	});

	// Events.
	if (fancyUrls) {
		$title.keyup(updateSlug);
		$title.keyup(handleShowSlugMessage);
		$slug.keyup(updateSlug);
		$slug.keyup(handleShowSlugMessage);
		$form.change(hardUpdateSlug);
	}

	$menuItem.click(clickMenuItem);
	$saveDraft.click(saveDraft);
	$publish.click(publish);
	$form.submit(publish);
	$title.keyup(maybeUpdateButtons);
	$url.keyup(maybeUpdateButtons);
	$form.change(maybeUpdateButtons);

	// Init.
	reset();
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9xdWljay1hZGQuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxPQUFPLGFBQUs7QUFDWCxLQUFNLFNBQVMsRUFBRSxnQkFBRixDQUFmO0FBQ0EsS0FBTSxRQUFRLE9BQU8sSUFBUCxDQUFZLFlBQVosQ0FBZDtBQUNBLEtBQU0sYUFBYSxFQUFFLHFCQUFGLENBQW5CO0FBQ0EsS0FBTSxXQUFXLEVBQUUsd0JBQUYsQ0FBakI7QUFDQSxLQUFNLFlBQVksRUFDakIsNkVBRGlCLENBQWxCO0FBR0EsS0FBTSxZQUFZLE9BQU8sSUFBUCxDQUFZLFdBQVosQ0FBbEI7QUFDQSxLQUFNLG1CQUFtQixPQUFPLElBQVAsQ0FBWSxvQkFBWixDQUF6QjtBQUNBLEtBQU0sU0FBUyxPQUFPLElBQVAsQ0FBWSxnQkFBWixDQUFmO0FBQ0EsS0FBTSxPQUFPLE9BQU8sSUFBUCxDQUFZLGNBQVosQ0FBYjtBQUNBLEtBQU0sUUFBUSxPQUFPLElBQVAsQ0FBWSxlQUFaLENBQWQ7QUFDQSxLQUFNLFFBQVEsT0FBTyxJQUFQLENBQVksb0JBQVosRUFBa0MsR0FBbEMsRUFBZDtBQUNBLEtBQU0seUJBQXlCLE1BQU0sSUFBTixDQUFXLGFBQVgsQ0FBL0I7QUFDQSxLQUFNLFlBQVksT0FBTyxPQUFQLENBQWUsU0FBakM7QUFmVyxLQWdCSixHQWhCSSxHQWdCUSxJQWhCUjtBQUFBLEtBZ0JDLEVBaEJELEdBZ0JjLEtBaEJkOzs7QUFrQlgsS0FBTSxjQUFjLFNBQWQsV0FBYztBQUFBLFNBQVU7QUFBQSxVQUFNLE9BQU8sTUFBUCxDQUFjLE1BQWQsQ0FBTjtBQUFBLEdBQVY7QUFBQSxFQUFwQjtBQUNBLEtBQU0sU0FBUyxZQUFZLFFBQVosQ0FBZjtBQUNBLEtBQU0sT0FBTyxZQUFZLE1BQVosQ0FBYjtBQUNBLEtBQU0sUUFBUSxZQUFZLE9BQVosQ0FBZDs7QUFFQSxLQUFNLG9CQUFvQixTQUFw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QUksUUFESztBQUVULE9BQUksUUFGSztBQUdULE9BQUk7QUFISyxHQVRHO0FBY2IsUUFBTTtBQUFBLFVBQU0sRUFBRSxvQkFBRixFQUF3QixJQUF4QixDQUE2QixPQUE3QixFQUFzQyxLQUF0QyxDQUFOO0FBQUEsR0FkTztBQWViLFVBQVE7QUFBQSxVQUFNLEVBQUUsMkJBQUYsRUFBK0IsUUFBL0IsQ0FBd0MsV0FBeEMsQ0FBTjtBQUFBO0FBZkssRUFBZDs7QUFrQkE7QUFDQSxLQUFJLFNBQUosRUFBZTtBQUNkLFNBQU8sS0FBUCxDQUFhLFVBQWI7QUFDQSxTQUFPLEtBQVAsQ0FBYSxxQkFBYjtBQUNBLFFBQU0sS0FBTixDQUFZLFVBQVo7QUFDQSxRQUFNLEtBQU4sQ0FBWSxxQkFBWjtBQUNBLFFBQU0sTUFBTixDQUFhLGNBQWI7QUFDQTs7QUFFRCxXQUFVLEtBQVYsQ0FBZ0IsYUFBaEI7QUFDQSxZQUFXLEtBQVgsQ0FBaUIsU0FBakI7QUFDQSxVQUFTLEtBQVQsQ0FBZSxPQUFmO0FBQ0EsT0FBTSxNQUFOLENBQWEsT0FBYjtBQUNBLFFBQU8sS0FBUCxDQUFhLGtCQUFiO0FBQ0EsTUFBSyxLQUFMLENBQVcsa0JBQVg7QUFDQSxPQUFNLE1BQU4sQ0FBYSxrQkFBYjs7QUFFQTtBQUNBO0FBQ0EsQ0FwS0QiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJqUXVlcnkoJCA9PiB7XG5cdGNvbnN0ICRtb2RhbCA9ICQoJyNwbHQtcXVpY2stYWRkJyk7XG5cdGNvbnN0ICRmb3JtID0gJG1vZGFsLmZpbmQoJ2Zvcm06Zmlyc3QnKTtcblx0Y29uc3QgJHNhdmVEcmFmdCA9ICQoJyNwbHQtcXVpY2stYWRkLXNhdmUnKTtcblx0Y29uc3QgJHB1Ymxpc2ggPSAkKCcjcGx0LXF1aWNrLWFkZC1wdWJsaXNoJyk7XG5cdGNvbnN0ICRtZW51SXRlbSA9ICQoXG5cdFx0J2FbaHJlZiQ9XCJwb3N0X3R5cGU9cGFnZSZwYWdlPXBsdC1hZGQtcGFnZS1saW5rXCJdLCBhW2hyZWYkPVwiI25ldy1wYWdlLWxpbmtcIl0nXG5cdCk7XG5cdGNvbnN0ICRtZXNzYWdlcyA9ICRtb2RhbC5maW5kKCcubWVzc2FnZXMnKTtcblx0Y29uc3QgJHNob3J0VXJsTWVzc2FnZSA9ICRtb2RhbC5maW5kKCcuc2hvcnQtdXJsLW1lc3NhZ2UnKTtcblx0Y29uc3QgJHRpdGxlID0gJG1vZGFsLmZpbmQoJ1tuYW1lPVwidGl0bGVcIl0nKTtcblx0Y29uc3QgJHVybCA9ICRtb2RhbC5maW5kKCdbbmFtZT1cInVybFwiXScpO1xuXHRjb25zdCAkc2x1ZyA9ICRtb2RhbC5maW5kKCdbbmFtZT1cInNsdWdcIl0nKTtcblx0Y29uc3Qgbm9uY2UgPSAkbW9kYWwuZmluZCgnW25hbWU9XCJwbHRfbm9uY2VcIl0nKS52YWwoKTtcblx0Y29uc3QgZGVmYXVsdFNsdWdQbGFjZWhvbGRlciA9ICRzbHVnLnByb3AoJ3BsYWNlaG9sZGVyJyk7XG5cdGNvbnN0IGZhbmN5VXJscyA9IHdpbmRvdy5wbHRWYXJzLmZhbmN5VXJscztcblx0Y29uc3QgW3llcywgbm9dID0gW3RydWUsIGZhbHNlXTtcblxuXHRjb25zdCBtb2RhbEFjdGlvbiA9IGFjdGlvbiA9PiAoKSA9PiAkbW9kYWwuZGlhbG9nKGFjdGlvbik7XG5cdGNvbnN0IGlzT3BlbiA9IG1vZGFsQWN0aW9uKCdpc09wZW4nKTtcblx0Y29uc3Qgb3BlbiA9IG1vZGFsQWN0aW9uKCdvcGVuJyk7XG5cdGNvbnN0IGNsb3NlID0gbW9kYWxBY3Rpb24oJ2Nsb3NlJyk7XG5cblx0Y29uc3QgbWFrZVNsdWdGcm9tVGl0bGUgPSAodGl0bGUgPSAnJykgPT4ge1xuXHRcdHJldHVybiB0aXRsZVxuXHRcdFx0LnRvTG93ZXJDYXNlKClcblx0XHRcdC5yZXBsYWNlKC9cXHMrL2csICctJylcblx0XHRcdC5yZXBsYWNlKC8tezIsfS9nLCAnLScpXG5cdFx0XHQucmVwbGFjZSgvW15hLXowLTktXS8sICcnKVxuXHRcdFx0LnJlcGxhY2UoLy0kLywgJycpXG5cdFx0XHQucmVwbGFjZSgvXi0vLCAnJyk7XG5cdH07XG5cblx0Y29uc3QgbWFrZVNsdWdGcm9tU2x1ZyA9IChzbHVnID0gJycpID0+IHtcblx0XHRyZXR1cm4gc2x1Z1xuXHRcdFx0LnRvTG93ZXJDYXNlKClcblx0XHRcdC5yZXBsYWNlKC9cXHMrL2csICctJylcblx0XHRcdC5yZXBsYWNlKC8tezIsfS9nLCAnLScpXG5cdFx0XHQucmVwbGFjZSgvW15hLXowLTktXS8sICcnKVxuXHRcdFx0LnJlcGxhY2UoL14tLywgJycpO1xuXHR9O1xuXG5cdGNvbnN0IGFkZE1lc3NhZ2UgPSBtZXNzYWdlID0+IHtcblx0XHRjb25zdCAkbmV3TWVzc2FnZSA9ICQoYDxwPiR7bWVzc2FnZX08L3A+YCk7XG5cdFx0JG1lc3NhZ2VzLmFwcGVuZCgkbmV3TWVzc2FnZSk7XG5cdFx0cmV0dXJuICRuZXdNZXNzYWdlO1xuXHR9O1xuXG5cdGNvbnN0IGFkZEV4cGlyaW5nTWVzc2FnZSA9IChtZXNzYWdlLCBkdXJhdGlvbikgPT4ge1xuXHRcdGNvbnN0ICRuZXdNZXNzYWdlID0gYWRkTWVzc2FnZShtZXNzYWdlKTtcblx0XHRzZXRUaW1lb3V0KCgpID0+ICRuZXdNZXNzYWdlLmZhZGVPdXQoKSwgZHVyYXRpb24pO1xuXHRcdHJldHVybiAkbmV3TWVzc2FnZTtcblx0fTtcblxuXHRjb25zdCBkaXNwbGF5U2hvcnRVcmxNZXNzYWdlID0gc2hvdyA9PiAkc2hvcnRVcmxNZXNzYWdlLnRvZ2dsZShzaG93KTtcblxuXHRjb25zdCB1cGRhdGVTbHVnID0gKCkgPT4ge1xuXHRcdGNvbnN0IHBsYWNlaG9sZGVyU2x1ZyA9IG1ha2VTbHVnRnJvbVRpdGxlKCR0aXRsZS52YWwoKSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IG1ha2VTbHVnRnJvbVNsdWcoJHNsdWcudmFsKCkpO1xuXG5cdFx0JHNsdWcucHJvcChcblx0XHRcdCdwbGFjZWhvbGRlcicsXG5cdFx0XHRwbGFjZWhvbGRlclNsdWcubGVuZ3RoID8gcGxhY2Vob2xkZXJTbHVnIDogZGVmYXVsdFNsdWdQbGFjZWhvbGRlclxuXHRcdCk7XG5cdFx0JHNsdWcudmFsKHNsdWcpO1xuXHR9O1xuXG5cdGNvbnN0IG5vRGVmYXVsdEV2ZW50ID0gZnVuYyA9PiBlID0+IHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZnVuYygpO1xuXHR9O1xuXG5cdGNvbnN0IGhhcmRVcGRhdGVTbHVnID0gbm9EZWZhdWx0RXZlbnQoKCkgPT5cblx0XHQkc2x1Zy52YWwobWFrZVNsdWdGcm9tVGl0bGUoJHNsdWcudmFsKCkpKVxuXHQpO1xuXG5cdGNvbnN0IGhhbmRsZVNob3dTbHVnTWVzc2FnZSA9IG5vRGVmYXVsdEV2ZW50KCgpID0+XG5cdFx0ZGlzcGxheVNob3J0VXJsTWVzc2FnZShcblx0XHRcdCRzbHVnLnByb3AoJ3BsYWNlaG9sZGVyJykubGVuZ3RoID4gMTYgJiYgISRzbHVnLnZhbCgpLmxlbmd0aFxuXHRcdClcblx0KTtcblxuXHRjb25zdCByZXNldCA9ICgpID0+IHtcblx0XHQkdGl0bGUudmFsKCcnKTtcblx0XHQkdXJsLnZhbCgnJyk7XG5cdFx0JHNsdWcudmFsKCcnKTtcblx0XHQkc2x1Zy5wcm9wKCdwbGFjZWhvbGRlcicsIGRlZmF1bHRTbHVnUGxhY2Vob2xkZXIpO1xuXHRcdG1heWJlVXBkYXRlQnV0dG9ucygpO1xuXHR9O1xuXG5cdGNvbnN0IHVwZGF0ZUJ1dHRvbnMgPSAoZW5hYmxlZCA9IHllcykgPT4ge1xuXHRcdCRwdWJsaXNoLnByb3AoJ2Rpc2FibGVkJywgIWVuYWJsZWQpO1xuXHRcdCRzYXZlRHJhZnQucHJvcCgnZGlzYWJsZWQnLCAhZW5hYmxlZCk7XG5cdH07XG5cblx0Y29uc3QgbWF5YmVVcGRhdGVCdXR0b25zID0gKCkgPT5cblx0XHR1cGRhdGVCdXR0b25zKCR0aXRsZS52YWwoKS5sZW5ndGggJiYgJHVybC52YWwoKS5sZW5ndGgpO1xuXG5cdGNvbnN0IHN1Ym1pdCA9ICh7IHB1Ymxpc2ggPSB5ZXMgfSA9IHt9KSA9PiB7XG5cdFx0Y29uc3QgdGl0bGUgPSAkdGl0bGUudmFsKCk7XG5cdFx0Y29uc3QgdXJsID0gJHVybC52YWwoKTtcblx0XHRsZXQgc2x1ZyA9ICRzbHVnLnZhbCgpID8gJHNsdWcudmFsKCkgOiBtYWtlU2x1Z0Zyb21UaXRsZSh0aXRsZSk7XG5cblx0XHQkLnBvc3QoXG5cdFx0XHRhamF4dXJsLFxuXHRcdFx0e1xuXHRcdFx0XHRhY3Rpb246ICdwbHRfcXVpY2tfYWRkJyxcblx0XHRcdFx0cGx0X3RpdGxlOiB0aXRsZSxcblx0XHRcdFx0cGx0X3VybDogdXJsLFxuXHRcdFx0XHRwbHRfc2x1Zzogc2x1Zyxcblx0XHRcdFx0cGx0X3B1Ymxpc2g6IHB1Ymxpc2ggPyAxIDogMCxcblx0XHRcdFx0cGx0X25vbmNlOiBub25jZSxcblx0XHRcdH0sXG5cdFx0XHRyZXNwb25zZSA9PiB7XG5cdFx0XHRcdGNvbnN0IHsgbWVzc2FnZSB9ID0gcmVzcG9uc2UuZGF0YTtcblx0XHRcdFx0Y29uc3QgZGVsYXkgPSA1MDAwO1xuXHRcdFx0XHRyZXNldCgpO1xuXHRcdFx0XHQkdGl0bGUuZm9jdXMoKTtcblx0XHRcdFx0YWRkRXhwaXJpbmdNZXNzYWdlKG1lc3NhZ2UsIGRlbGF5KTtcblx0XHRcdH1cblx0XHQpO1xuXHR9O1xuXG5cdGNvbnN0IGNsaWNrTWVudUl0ZW0gPSBub0RlZmF1bHRFdmVudCgoKSA9PiAoaXNPcGVuKCkgPyBjbG9zZSgpIDogb3BlbigpKSk7XG5cdGNvbnN0IHNhdmVEcmFmdCA9IG5vRGVmYXVsdEV2ZW50KCgpID0+IHN1Ym1pdCh7IHB1Ymxpc2g6IG5vIH0pKTtcblx0Y29uc3QgcHVibGlzaCA9IG5vRGVmYXVsdEV2ZW50KCgpID0+IHN1Ym1pdCh7IHB1Ymxpc2g6IHllcyB9KSk7XG5cblx0JG1vZGFsLmRpYWxvZyh7XG5cdFx0dGl0bGU6ICdBZGQgUGFnZSBMaW5rJyxcblx0XHRkaWFsb2dDbGFzczogJ3dwLWRpYWxvZycsXG5cdFx0YXV0b09wZW46IG5vLFxuXHRcdGRyYWdnYWJsZTogbm8sXG5cdFx0d2lkdGg6ICdhdXRvJyxcblx0XHRtb2RhbDogeWVzLFxuXHRcdHJlc2l6YWJsZTogbm8sXG5cdFx0Y2xvc2VPbkVzY2FwZTogeWVzLFxuXHRcdHBvc2l0aW9uOiB7XG5cdFx0XHRteTogJ2NlbnRlcicsXG5cdFx0XHRhdDogJ2NlbnRlcicsXG5cdFx0XHRvZjogd2luZG93LFxuXHRcdH0sXG5cdFx0b3BlbjogKCkgPT4gJCgnLnVpLXdpZGdldC1vdmVybGF5JykuYmluZCgnY2xpY2snLCBjbG9zZSksXG5cdFx0Y3JlYXRlOiAoKSA9PiAkKCcudWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlJykuYWRkQ2xhc3MoJ3VpLWJ1dHRvbicpLFxuXHR9KTtcblxuXHQvLyBFdmVudHMuXG5cdGlmIChmYW5jeVVybHMpIHtcblx0XHQkdGl0bGUua2V5dXAodXBkYXRlU2x1Zyk7XG5cdFx0JHRpdGxlLmtleXVwKGhhbmRsZVNob3dTbHVnTWVzc2FnZSk7XG5cdFx0JHNsdWcua2V5dXAodXBkYXRlU2x1Zyk7XG5cdFx0JHNsdWcua2V5dXAoaGFuZGxlU2hvd1NsdWdNZXNzYWdlKTtcblx0XHQkZm9ybS5jaGFuZ2UoaGFyZFVwZGF0ZVNsdWcpO1xuXHR9XG5cblx0JG1lbnVJdGVtLmNsaWNrKGNsaWNrTWVudUl0ZW0pO1xuXHQkc2F2ZURyYWZ0LmNsaWNrKHNhdmVEcmFmdCk7XG5cdCRwdWJsaXNoLmNsaWNrKHB1Ymxpc2gpO1xuXHQkZm9ybS5zdWJtaXQocHVibGlzaCk7XG5cdCR0aXRsZS5rZXl1cChtYXliZVVwZGF0ZUJ1dHRvbnMpO1xuXHQkdXJsLmtleXVwKG1heWJlVXBkYXRlQnV0dG9ucyk7XG5cdCRmb3JtLmNoYW5nZShtYXliZVVwZGF0ZUJ1dHRvbnMpO1xuXG5cdC8vIEluaXQuXG5cdHJlc2V0KCk7XG59KTtcbiJdfQ==
